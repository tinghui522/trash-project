{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _extends from \"@babel/runtime/helpers/extends\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"C:\\\\Users\\\\User\\\\Desktop\\\\NTUE\\\\\\u4E09\\u4E0B\\\\\\u7562\\u903C\\u55F6\\u5C08\\\\\\u7A0B\\u5F0F\\\\trash-project\\\\node_modules\\\\react-native-calendars\\\\src\\\\expandableCalendar\\\\agendaList.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport _ from 'lodash';\nimport React, { Component } from 'react';\nimport SectionList from \"react-native-web/dist/exports/SectionList\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport PropTypes from 'prop-types';\nimport XDate from 'xdate';\nimport dateutils from \"../dateutils\";\nimport styleConstructor from \"./style\";\nimport asCalendarConsumer from \"./asCalendarConsumer\";\nimport { getMoment } from \"../momentResolver\";\n\nvar commons = require(\"./commons\");\n\nvar UPDATE_SOURCES = commons.UPDATE_SOURCES;\n\nvar AgendaList = function (_Component) {\n  _inherits(AgendaList, _Component);\n\n  var _super = _createSuper(AgendaList);\n\n  function AgendaList(props) {\n    var _this;\n\n    _classCallCheck(this, AgendaList);\n\n    _this = _super.call(this, props);\n\n    _this.onViewableItemsChanged = function (_ref) {\n      var viewableItems = _ref.viewableItems;\n\n      if (viewableItems && !_this.sectionScroll) {\n        var topSection = _.get(viewableItems[0], 'section.title');\n\n        if (topSection && topSection !== _this._topSection) {\n          _this._topSection = topSection;\n\n          if (_this.didScroll && !_this.props.avoidDateUpdates) {\n            _.invoke(_this.props.context, 'setDate', _this._topSection, UPDATE_SOURCES.LIST_DRAG);\n          }\n        }\n      }\n    };\n\n    _this.onScroll = function (event) {\n      if (!_this.didScroll) {\n        _this.didScroll = true;\n      }\n\n      _.invoke(_this.props, 'onScroll', event);\n    };\n\n    _this.onMomentumScrollBegin = function (event) {\n      _.invoke(_this.props.context, 'setDisabled', true);\n\n      _.invoke(_this.props, 'onMomentumScrollBegin', event);\n    };\n\n    _this.onMomentumScrollEnd = function (event) {\n      _this.sectionScroll = false;\n\n      _.invoke(_this.props.context, 'setDisabled', false);\n\n      _.invoke(_this.props, 'onMomentumScrollEnd', event);\n    };\n\n    _this.onScrollToIndexFailed = function (info) {\n      console.warn('onScrollToIndexFailed info: ', info);\n    };\n\n    _this.onHeaderLayout = function (_ref2) {\n      var nativeEvent = _ref2.nativeEvent;\n      _this.sectionHeight = nativeEvent.layout.height;\n    };\n\n    _this.renderSectionHeader = function (_ref3) {\n      var title = _ref3.section.title;\n      var _this$props = _this.props,\n          renderSectionHeader = _this$props.renderSectionHeader,\n          sectionStyle = _this$props.sectionStyle;\n\n      if (renderSectionHeader) {\n        return renderSectionHeader(title);\n      }\n\n      return React.createElement(Text, {\n        allowFontScaling: false,\n        style: [_this.style.sectionText, sectionStyle],\n        onLayout: _this.onHeaderLayout,\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 7\n        }\n      }, _this.getSectionTitle(title));\n    };\n\n    _this.keyExtractor = function (item, index) {\n      var keyExtractor = _this.props.keyExtractor;\n      return _.isFunction(keyExtractor) ? keyExtractor(item, index) : String(index);\n    };\n\n    _this.style = styleConstructor(props.theme);\n    _this._topSection = _.get(props, 'sections[0].title');\n    _this.didScroll = false;\n    _this.sectionScroll = false;\n    _this.viewabilityConfig = {\n      itemVisiblePercentThreshold: 20\n    };\n    _this.list = React.createRef();\n    return _this;\n  }\n\n  _createClass(AgendaList, [{\n    key: \"getSectionIndex\",\n    value: function getSectionIndex(date) {\n      var i;\n\n      _.map(this.props.sections, function (section, index) {\n        if (section.title === date) {\n          i = index;\n          return;\n        }\n      });\n\n      return i;\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var date = this.props.context.date;\n\n      if (date !== this._topSection) {\n        setTimeout(function () {\n          var sectionIndex = _this2.getSectionIndex(date);\n\n          _this2.scrollToSection(sectionIndex);\n        }, 500);\n      }\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      var _this$props$context = this.props.context,\n          updateSource = _this$props$context.updateSource,\n          date = _this$props$context.date;\n\n      if (date !== prevProps.context.date) {\n        if (updateSource !== UPDATE_SOURCES.LIST_DRAG && updateSource !== UPDATE_SOURCES.CALENDAR_INIT) {\n          var sectionIndex = this.getSectionIndex(date);\n          this.scrollToSection(sectionIndex);\n        }\n      }\n    }\n  }, {\n    key: \"getSectionTitle\",\n    value: function getSectionTitle(title) {\n      if (!title) return;\n      var _this$props2 = this.props,\n          dayFormatter = _this$props2.dayFormatter,\n          dayFormat = _this$props2.dayFormat,\n          useMoment = _this$props2.useMoment,\n          markToday = _this$props2.markToday;\n      var sectionTitle = title;\n\n      if (dayFormatter) {\n        sectionTitle = dayFormatter(title);\n      } else if (dayFormat) {\n        if (useMoment) {\n          var moment = getMoment();\n          sectionTitle = moment(title).format(dayFormat);\n        } else {\n          sectionTitle = XDate(title).toString(dayFormat);\n        }\n      }\n\n      if (markToday) {\n        var todayString = XDate.locales[XDate.defaultLocale].today || commons.todayString;\n        var isToday = dateutils.isToday(XDate(title));\n        sectionTitle = isToday ? todayString + \", \" + sectionTitle : sectionTitle;\n      }\n\n      return sectionTitle;\n    }\n  }, {\n    key: \"scrollToSection\",\n    value: function scrollToSection(sectionIndex) {\n      if (this.list.current && sectionIndex !== undefined) {\n        this.sectionScroll = true;\n        this._topSection = this.props.sections[sectionIndex].title;\n        this.list.current.scrollToLocation({\n          animated: true,\n          sectionIndex: sectionIndex,\n          itemIndex: 0,\n          viewPosition: 0,\n          viewOffset: commons.isAndroid ? this.sectionHeight : 0\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var props = _.omit(this.props, 'context');\n\n      return React.createElement(SectionList, _extends({}, props, {\n        ref: this.list,\n        keyExtractor: this.keyExtractor,\n        showsVerticalScrollIndicator: false,\n        onViewableItemsChanged: this.onViewableItemsChanged,\n        viewabilityConfig: this.viewabilityConfig,\n        renderSectionHeader: this.renderSectionHeader,\n        onScroll: this.onScroll,\n        onMomentumScrollBegin: this.onMomentumScrollBegin,\n        onMomentumScrollEnd: this.onMomentumScrollEnd,\n        onScrollToIndexFailed: this.onScrollToIndexFailed,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 7\n        }\n      }));\n    }\n  }]);\n\n  return AgendaList;\n}(Component);\n\nAgendaList.displayName = 'AgendaList';\nAgendaList.propTypes = _objectSpread(_objectSpread({}, SectionList.propTypes), {}, {\n  dayFormat: PropTypes.string,\n  dayFormatter: PropTypes.func,\n  useMoment: PropTypes.bool,\n  markToday: PropTypes.bool,\n  sectionStyle: PropTypes.oneOfType([PropTypes.object, PropTypes.number, PropTypes.array]),\n  avoidDateUpdates: PropTypes.bool\n});\nAgendaList.defaultProps = {\n  dayFormat: 'dddd, MMM d',\n  stickySectionHeadersEnabled: true,\n  markToday: true\n};\nexport default asCalendarConsumer(AgendaList);","map":{"version":3,"sources":["C:/Users/User/Desktop/NTUE/三下/畢逼嗶專/程式/trash-project/node_modules/react-native-calendars/src/expandableCalendar/agendaList.js"],"names":["_","React","Component","PropTypes","XDate","dateutils","styleConstructor","asCalendarConsumer","getMoment","commons","require","UPDATE_SOURCES","AgendaList","props","onViewableItemsChanged","viewableItems","sectionScroll","topSection","get","_topSection","didScroll","avoidDateUpdates","invoke","context","LIST_DRAG","onScroll","event","onMomentumScrollBegin","onMomentumScrollEnd","onScrollToIndexFailed","info","console","warn","onHeaderLayout","nativeEvent","sectionHeight","layout","height","renderSectionHeader","title","section","sectionStyle","style","sectionText","getSectionTitle","keyExtractor","item","index","isFunction","String","theme","viewabilityConfig","itemVisiblePercentThreshold","list","createRef","date","i","map","sections","setTimeout","sectionIndex","getSectionIndex","scrollToSection","prevProps","updateSource","CALENDAR_INIT","dayFormatter","dayFormat","useMoment","markToday","sectionTitle","moment","format","toString","todayString","locales","defaultLocale","today","isToday","current","undefined","scrollToLocation","animated","itemIndex","viewPosition","viewOffset","isAndroid","omit","displayName","propTypes","SectionList","string","func","bool","oneOfType","object","number","array","defaultProps","stickySectionHeadersEnabled"],"mappings":"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","sourcesContent":["import _ from 'lodash';\nimport React, {Component} from 'react';\nimport {SectionList, Text} from 'react-native';\nimport PropTypes from 'prop-types';\nimport XDate from 'xdate';\nimport dateutils from '../dateutils';\nimport styleConstructor from './style';\nimport asCalendarConsumer from './asCalendarConsumer';\nimport {getMoment} from '../momentResolver';\n\nconst commons = require('./commons');\nconst UPDATE_SOURCES = commons.UPDATE_SOURCES;\n\n/**\n * @description: AgendaList component\n * @note: Should be wrapped with 'CalendarProvider'\n * @extends: SectionList\n * @example: https://github.com/wix/react-native-calendars/blob/master/example/src/screens/expandableCalendar.js\n */\nclass AgendaList extends Component {\n  static displayName = 'AgendaList';\n\n  static propTypes = {\n    ...SectionList.propTypes,\n    /** day format in section title. Formatting values: http://arshaw.com/xdate/#Formatting */\n    dayFormat: PropTypes.string,\n    /** a function to custom format the section header's title */\n    dayFormatter: PropTypes.func,\n    /** whether to use moment.js for date string formatting\n     * (remember to pass 'dayFormat' with appropriate format, like 'dddd, MMM D') */\n    useMoment: PropTypes.bool,\n    /** whether to mark today's title with the \"Today, ...\" string. Default = true */\n    markToday: PropTypes.bool,\n    /** style passed to the section view */\n    sectionStyle: PropTypes.oneOfType([PropTypes.object, PropTypes.number, PropTypes.array]),\n    /** whether to block the date change in calendar (and calendar context provider) when agenda scrolls */\n    avoidDateUpdates: PropTypes.bool\n  };\n\n  static defaultProps = {\n    dayFormat: 'dddd, MMM d',\n    stickySectionHeadersEnabled: true,\n    markToday: true\n  };\n\n  constructor(props) {\n    super(props);\n    this.style = styleConstructor(props.theme);\n\n    this._topSection = _.get(props, 'sections[0].title');\n    this.didScroll = false;\n    this.sectionScroll = false;\n\n    this.viewabilityConfig = {\n      itemVisiblePercentThreshold: 20 // 50 means if 50% of the item is visible\n    };\n    this.list = React.createRef();\n  }\n\n  getSectionIndex(date) {\n    let i;\n    _.map(this.props.sections, (section, index) => {\n      // NOTE: sections titles should match current date format!!!\n      if (section.title === date) {\n        i = index;\n        return;\n      }\n    });\n    return i;\n  }\n\n  componentDidMount() {\n    const {date} = this.props.context;\n    if (date !== this._topSection) {\n      setTimeout(() => {\n        const sectionIndex = this.getSectionIndex(date);\n        this.scrollToSection(sectionIndex);\n      }, 500);\n    }\n  }\n\n  componentDidUpdate(prevProps) {\n    const {updateSource, date} = this.props.context;\n    if (date !== prevProps.context.date) {\n      // NOTE: on first init data should set first section to the current date!!!\n      if (updateSource !== UPDATE_SOURCES.LIST_DRAG && updateSource !== UPDATE_SOURCES.CALENDAR_INIT) {\n        const sectionIndex = this.getSectionIndex(date);\n        this.scrollToSection(sectionIndex);\n      }\n    }\n  }\n\n  getSectionTitle(title) {\n    if (!title) return;\n\n    const {dayFormatter, dayFormat, useMoment, markToday} = this.props;\n    let sectionTitle = title;\n\n    if (dayFormatter) {\n      sectionTitle = dayFormatter(title);\n    } else if (dayFormat) {\n      if (useMoment) {\n        const moment = getMoment();\n        sectionTitle = moment(title).format(dayFormat);\n      } else {\n        sectionTitle = XDate(title).toString(dayFormat);\n      }\n    }\n\n    if (markToday) {\n      const todayString = XDate.locales[XDate.defaultLocale].today || commons.todayString;\n      const isToday = dateutils.isToday(XDate(title));\n      sectionTitle = isToday ? `${todayString}, ${sectionTitle}` : sectionTitle;\n    }\n\n    return sectionTitle;\n  }\n\n  scrollToSection(sectionIndex) {\n    if (this.list.current && sectionIndex !== undefined) {\n      this.sectionScroll = true; // to avoid setDate() in onViewableItemsChanged\n      this._topSection = this.props.sections[sectionIndex].title;\n\n      this.list.current.scrollToLocation({\n        animated: true,\n        sectionIndex: sectionIndex,\n        itemIndex: 0,\n        viewPosition: 0, // position at the top\n        viewOffset: commons.isAndroid ? this.sectionHeight : 0\n      });\n    }\n  }\n\n  onViewableItemsChanged = ({viewableItems}) => {\n    if (viewableItems && !this.sectionScroll) {\n      const topSection = _.get(viewableItems[0], 'section.title');\n      if (topSection && topSection !== this._topSection) {\n        this._topSection = topSection;\n        if (this.didScroll && !this.props.avoidDateUpdates) {\n          // to avoid setDate() on first load (while setting the initial context.date value)\n          _.invoke(this.props.context, 'setDate', this._topSection, UPDATE_SOURCES.LIST_DRAG);\n        }\n      }\n    }\n  };\n\n  onScroll = event => {\n    if (!this.didScroll) {\n      this.didScroll = true;\n    }\n    _.invoke(this.props, 'onScroll', event);\n  };\n\n  onMomentumScrollBegin = event => {\n    _.invoke(this.props.context, 'setDisabled', true);\n    _.invoke(this.props, 'onMomentumScrollBegin', event);\n  };\n\n  onMomentumScrollEnd = event => {\n    // when list momentum ends AND when scrollToSection scroll ends\n    this.sectionScroll = false;\n    _.invoke(this.props.context, 'setDisabled', false);\n    _.invoke(this.props, 'onMomentumScrollEnd', event);\n  };\n\n  onScrollToIndexFailed = (info) => {\n    console.warn('onScrollToIndexFailed info: ', info);\n  }\n\n  onHeaderLayout = ({nativeEvent}) => {\n    this.sectionHeight = nativeEvent.layout.height;\n  };\n\n  renderSectionHeader = ({section: {title}}) => {\n    const {renderSectionHeader, sectionStyle} = this.props;\n\n    if (renderSectionHeader) {\n      return renderSectionHeader(title);\n    }\n\n    return (\n      <Text allowFontScaling={false} style={[this.style.sectionText, sectionStyle]} onLayout={this.onHeaderLayout}>\n        {this.getSectionTitle(title)}\n      </Text>\n    );\n  };\n\n  keyExtractor = (item, index) => {\n    const {keyExtractor} = this.props;\n    return _.isFunction(keyExtractor) ? keyExtractor(item, index) : String(index);\n  };\n\n  render() {\n    const props = _.omit(this.props, 'context');\n\n    return (\n      <SectionList\n        {...props}\n        ref={this.list}\n        keyExtractor={this.keyExtractor}\n        showsVerticalScrollIndicator={false}\n        onViewableItemsChanged={this.onViewableItemsChanged}\n        viewabilityConfig={this.viewabilityConfig}\n        renderSectionHeader={this.renderSectionHeader}\n        onScroll={this.onScroll}\n        onMomentumScrollBegin={this.onMomentumScrollBegin}\n        onMomentumScrollEnd={this.onMomentumScrollEnd}\n        onScrollToIndexFailed={this.onScrollToIndexFailed}\n        // getItemLayout={this.getItemLayout} // onViewableItemsChanged is not updated when list scrolls!!!\n      />\n    );\n  }\n\n  // getItemLayout = (data, index) => {\n  //   return {length: commons.screenWidth, offset: commons.screenWidth  * index, index};\n  // }\n}\n\nexport default asCalendarConsumer(AgendaList);\n"]},"metadata":{},"sourceType":"module"}